<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BWIA - Matching Inteligente de Empleo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root { --primary: #0F172A; --secondary: #F97316; --accent: #3B82F6; --success: #10B981; }
    body { font-family: 'Inter', sans-serif; background: #F8FAFC; }
    h1, h2, h3 { font-family: 'Sora', sans-serif; }
    .gradient-bg { background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #334155 100%); }
    .card { background: white; border-radius: 1rem; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s; }
    .card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.15); }
    .btn-primary { background: linear-gradient(135deg, #F97316 0%, #EA580C 100%); color: white; padding: 1rem 2rem; border-radius: 0.75rem; font-weight: 600; border: none; cursor: pointer; transition: all 0.3s; display: inline-block; text-decoration: none; text-align: center; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 16px rgba(249,115,22,0.3); }
    .btn-secondary { background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%); color: white; padding: 1rem 2rem; border-radius: 0.75rem; font-weight: 600; border: none; cursor: pointer; transition: all 0.3s; display: inline-block; text-decoration: none; text-align: center; }
    .btn-secondary:hover { transform: translateY(-2px); box-shadow: 0 8px 16px rgba(59,130,246,0.3); }
    .btn-whatsapp { background: linear-gradient(135deg, #25D366 0%, #128C7E 100%); color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; border: none; cursor: pointer; transition: all 0.3s; display: inline-block; text-decoration: none; font-size: 0.875rem; }
    .btn-email { background: linear-gradient(135deg, #6366F1 0%, #4F46E5 100%); color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; border: none; cursor: pointer; transition: all 0.3s; display: inline-block; text-decoration: none; font-size: 0.875rem; }
    .form-input { width: 100%; padding: 0.75rem 1rem; border: 2px solid #E2E8F0; border-radius: 0.5rem; transition: all 0.3s; font-size: 1rem; }
    .form-input:focus { outline: none; border-color: #3B82F6; box-shadow: 0 0 0 3px rgba(59,130,246,0.1); }
    .match-card { background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%); border-left: 4px solid #3B82F6; padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1rem; }
    .compatibility-badge { display: inline-block; padding: 0.5rem 1rem; border-radius: 2rem; font-weight: 600; font-size: 0.875rem; }
    .high { background: #D1FAE5; color: #065F46; }
    .medium { background: #FEF3C7; color: #92400E; }
    .low { background: #FEE2E2; color: #991B1B; }
    .loading { border: 3px solid #f3f3f3; border-top: 3px solid #3B82F6; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .hidden { display: none; }
    .status-bar { background: #ECFDF5; border: 1px solid #10B981; border-radius: 0.5rem; padding: 0.75rem 1rem; margin-bottom: 1rem; color: #065F46; font-size: 0.875rem; }
    .status-bar.loading-status { background: #EFF6FF; border-color: #3B82F6; color: #1E40AF; }
    .status-bar.error-status { background: #FEF2F2; border-color: #EF4444; color: #991B1B; }
  </style>
</head>
<body>

  <!-- Header -->
  <nav class="gradient-bg py-4 sticky top-0 z-50 shadow-lg">
    <div class="container mx-auto px-4 flex justify-between items-center">
      <h1 class="text-3xl font-bold text-white">BWIA<span class="text-orange-400">¬∑AI</span></h1>
      <div class="flex gap-4">
        <button onclick="showSection('candidato')" class="text-white hover:text-orange-400 transition">Busco Empleo</button>
        <button onclick="showSection('empresa')" class="text-white hover:text-orange-400 transition">Busco Talento</button>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="gradient-bg py-20 text-white">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-5xl font-bold mb-4">Matching Inteligente con IA</h2>
      <p class="text-xl mb-8 text-gray-300">Conectamos talento con oportunidades usando inteligencia artificial</p>
      <div class="flex justify-center gap-4">
        <button onclick="showSection('candidato')" class="btn-primary">Soy Candidato</button>
        <button onclick="showSection('empresa')" class="btn-secondary">Soy Empresa</button>
      </div>
      <div class="mt-12 grid grid-cols-3 gap-8 max-w-3xl mx-auto">
        <div><div class="text-4xl font-bold text-orange-400">98%</div><div class="text-gray-300 mt-2">Precisi√≥n IA</div></div>
        <div><div class="text-4xl font-bold text-orange-400">&lt;2min</div><div class="text-gray-300 mt-2">Matching</div></div>
        <div><div class="text-4xl font-bold text-orange-400">24/7</div><div class="text-gray-300 mt-2">Disponible</div></div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="container mx-auto px-4 py-12">

    <!-- Candidate Section -->
    <section id="candidate-section" class="hidden">
      <div class="max-w-4xl mx-auto">
        <div class="card">
          <h2 class="text-3xl font-bold mb-6 text-gray-900">Encuentra tu Empleo Ideal üéØ</h2>
          <p class="text-gray-600 mb-8">Completa tu perfil y la IA te mostrar√° las mejores oportunidades al instante</p>
          <div id="db-status-candidato" class="status-bar loading-status">‚è≥ Cargando vacantes disponibles...</div>
          
          <form id="candidate-form">
            <div class="grid md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block font-semibold mb-2">Nombre Completo *</label>
                <input type="text" name="name" required class="form-input" placeholder="Juan P√©rez">
              </div>
              <div>
                <label class="block font-semibold mb-2">Email *</label>
                <input type="email" name="email" required class="form-input" placeholder="juan@email.com">
              </div>
            </div>
            <div class="grid md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block font-semibold mb-2">Tel√©fono</label>
                <input type="tel" name="phone" class="form-input" placeholder="+52 614 123 4567">
              </div>
              <div>
                <label class="block font-semibold mb-2">Ubicaci√≥n *</label>
                <input type="text" name="location" required class="form-input" placeholder="Chihuahua, Chih">
              </div>
            </div>
            <div class="mb-6">
              <label class="block font-semibold mb-2">Puesto Deseado *</label>
              <input type="text" name="desired_position" required class="form-input" placeholder="Ej: Contador, Repartidor, Vendedor">
            </div>
            <div class="mb-6">
              <label class="block font-semibold mb-2">Habilidades Clave * <span class="text-sm text-gray-500">(separadas por comas)</span></label>
              <textarea name="skills" required class="form-input" rows="3" placeholder="Ej: Contabilidad, Excel, SAT, Manejo de moto"></textarea>
            </div>
            <div class="grid md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block font-semibold mb-2">A√±os de Experiencia *</label>
                <select name="experience" required class="form-input">
                  <option value="">Selecciona...</option>
                  <option value="0-1">0-1 a√±os</option>
                  <option value="1-3">1-3 a√±os</option>
                  <option value="3-5">3-5 a√±os</option>
                  <option value="5-10">5-10 a√±os</option>
                  <option value="10+">M√°s de 10 a√±os</option>
                </select>
              </div>
              <div>
                <label class="block font-semibold mb-2">Salario Deseado (MXN mensual)</label>
                <input type="number" name="salary" class="form-input" placeholder="15000">
              </div>
            </div>
            <div class="mb-6">
              <label class="block font-semibold mb-2">Sobre ti (experiencia, logros, objetivos)</label>
              <textarea name="about" class="form-input" rows="4" placeholder="Cu√©ntanos sobre tu experiencia..."></textarea>
            </div>
            <button type="submit" class="btn-primary w-full text-lg">üöÄ Encontrar Vacantes Compatibles</button>
          </form>
        </div>

        <div id="candidate-results" class="hidden mt-8">
          <div class="card">
            <h3 class="text-2xl font-bold mb-4">üéØ Vacantes que coinciden con tu perfil</h3>
            <div id="candidate-matches"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Employer Section -->
    <section id="employer-section" class="hidden">
      <div class="max-w-4xl mx-auto">
        <div class="card">
          <h2 class="text-3xl font-bold mb-6 text-gray-900">Encuentra el Talento Perfecto üíº</h2>
          <p class="text-gray-600 mb-8">Publica tu vacante y la IA te mostrar√° los candidatos m√°s aptos al instante</p>
          <div id="db-status-empresa" class="status-bar loading-status">‚è≥ Cargando candidatos disponibles...</div>

          <form id="employer-form">
            <div class="grid md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block font-semibold mb-2">Nombre de la Empresa *</label>
                <input type="text" name="company" required class="form-input" placeholder="Mi Empresa SA">
              </div>
              <div>
                <label class="block font-semibold mb-2">Email de Contacto *</label>
                <input type="email" name="email" required class="form-input" placeholder="rh@empresa.com">
              </div>
            </div>
            <div class="grid md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block font-semibold mb-2">Tel√©fono</label>
                <input type="tel" name="phone" class="form-input" placeholder="+52 614 123 4567">
              </div>
              <div>
                <label class="block font-semibold mb-2">Ubicaci√≥n de la Vacante *</label>
                <input type="text" name="location" required class="form-input" placeholder="Chihuahua, Chih">
              </div>
            </div>
            <div class="mb-6">
              <label class="block font-semibold mb-2">Puesto Ofrecido *</label>
              <input type="text" name="position" required class="form-input" placeholder="Ej: Contador General, Repartidor">
            </div>
            <div class="mb-6">
              <label class="block font-semibold mb-2">Habilidades Requeridas * <span class="text-sm text-gray-500">(separadas por comas)</span></label>
              <textarea name="requirements" required class="form-input" rows="3" placeholder="Ej: Contabilidad, SAT, Excel, Manejo de moto"></textarea>
            </div>
            <div class="grid md:grid-cols-2 gap-6 mb-6">
              <div>
                <label class="block font-semibold mb-2">Experiencia Requerida *</label>
                <select name="experience" required class="form-input">
                  <option value="">Selecciona...</option>
                  <option value="0-1">0-1 a√±os</option>
                  <option value="1-3">1-3 a√±os</option>
                  <option value="3-5">3-5 a√±os</option>
                  <option value="5-10">5-10 a√±os</option>
                  <option value="10+">M√°s de 10 a√±os</option>
                </select>
              </div>
              <div>
                <label class="block font-semibold mb-2">Salario Ofrecido (MXN mensual)</label>
                <input type="number" name="salary" class="form-input" placeholder="15000">
              </div>
            </div>
            <div class="mb-6">
              <label class="block font-semibold mb-2">Descripci√≥n de la Vacante</label>
              <textarea name="description" class="form-input" rows="4" placeholder="Describe responsabilidades y beneficios..."></textarea>
            </div>
            <button type="submit" class="btn-secondary w-full text-lg">üéØ Encontrar Candidatos Compatibles</button>
          </form>
        </div>

        <div id="employer-results" class="hidden mt-8">
          <div class="card">
            <h3 class="text-2xl font-bold mb-4">üíº Candidatos que coinciden con tu vacante</h3>
            <div id="employer-matches"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Welcome Section -->
    <section id="welcome-section">
      <div class="max-w-6xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-4xl font-bold mb-4">¬øC√≥mo funciona el Matching con IA?</h2>
          <p class="text-xl text-gray-600">Tecnolog√≠a de punta para conectar talento con oportunidades</p>
        </div>
        <div class="grid md:grid-cols-3 gap-8">
          <div class="card text-center"><div class="text-5xl mb-4">üìù</div><h3 class="text-xl font-bold mb-3">1. Completa tu Perfil</h3><p class="text-gray-600">Candidatos o empresas llenan un formulario con sus necesidades</p></div>
          <div class="card text-center"><div class="text-5xl mb-4">ü§ñ</div><h3 class="text-xl font-bold mb-3">2. IA Analiza</h3><p class="text-gray-600">Nuestra IA analiza habilidades, experiencia y compatibilidad</p></div>
          <div class="card text-center"><div class="text-5xl mb-4">‚ú®</div><h3 class="text-xl font-bold mb-3">3. Matches Instant√°neos</h3><p class="text-gray-600">Recibes resultados personalizados en menos de 2 minutos</p></div>
        </div>
        <div class="mt-12 text-center">
          <div class="card bg-gradient-to-r from-orange-50 to-blue-50">
            <h3 class="text-2xl font-bold mb-4">üéØ Precisi√≥n del 98% en Matches</h3>
            <p class="text-gray-700 mb-6">Nuestra IA considera m√∫ltiples factores: habilidades t√©cnicas, experiencia, ubicaci√≥n y expectativas salariales</p>
            <div class="flex justify-center gap-4">
              <button onclick="showSection('candidato')" class="btn-primary">Busco Empleo</button>
              <button onclick="showSection('empresa')" class="btn-secondary">Busco Talento</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-8 mt-20">
    <div class="container mx-auto px-4 text-center">
      <p class="text-xl font-bold mb-2">BWIA<span class="text-orange-400">¬∑AI</span></p>
      <p class="text-gray-400">Matching Inteligente de Empleo Powered by IA</p>
      <p class="text-gray-500 text-sm mt-4">&copy; 2026 BWIA. Todos los derechos reservados.</p>
    </div>
  </footer>

  <script>
    // ============================================================
    // CONFIGURACI√ìN - CAMBIA ESTA URL SI REDEPLOYS EL SCRIPT
    // ============================================================
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz_X7DJoTI-zOURJSUu2DSnjr8abP0ZKMalbBmhAUw_H3-IOrvlKy_3yfzYxaZ36zVjzw/exec';

    // Base de datos en memoria + datos cargados de Google Sheets
    const database = {
      candidates: [],
      jobs: []
    };

    let sheetsLoaded = false;

    // ============================================================
    // CARGAR DATOS DE GOOGLE SHEETS AL INICIO
    // ============================================================
    async function loadFromSheets() {
      try {
        const response = await fetch(SCRIPT_URL + '?action=getAll', {
          method: 'GET',
          mode: 'cors'
        });
        const data = await response.json();

        if (data.candidates) {
          database.candidates = data.candidates;
        }
        if (data.jobs) {
          database.jobs = data.jobs;
        }

        sheetsLoaded = true;
        updateStatusBars('success');
        console.log(`‚úÖ Cargados: ${database.candidates.length} candidatos, ${database.jobs.length} vacantes`);
      } catch (error) {
        console.log('‚ö†Ô∏è No se pudo conectar con Google Sheets, usando datos locales');
        sheetsLoaded = false;
        updateStatusBars('error');
      }
    }

    function updateStatusBars(status) {
      const statusC = document.getElementById('db-status-candidato');
      const statusE = document.getElementById('db-status-empresa');
      
      if (status === 'success') {
        const msg = `‚úÖ ${database.jobs.length} vacante(s) y ${database.candidates.length} candidato(s) cargados en tiempo real`;
        if (statusC) { statusC.className = 'status-bar'; statusC.textContent = msg; }
        if (statusE) { statusE.className = 'status-bar'; statusE.textContent = msg; }
      } else {
        const msg = '‚ö†Ô∏è Modo offline ‚Äî los matches ser√°n de esta sesi√≥n √∫nicamente';
        if (statusC) { statusC.className = 'status-bar error-status'; statusC.textContent = msg; }
        if (statusE) { statusE.className = 'status-bar error-status'; statusE.textContent = msg; }
      }
    }

    // Iniciar carga de datos
    loadFromSheets();

    // ============================================================
    // NAVEGACI√ìN
    // ============================================================
    function showSection(section) {
      document.getElementById('welcome-section').classList.add('hidden');
      document.getElementById('candidate-section').classList.add('hidden');
      document.getElementById('employer-section').classList.add('hidden');
      if (section === 'candidato') document.getElementById('candidate-section').classList.remove('hidden');
      else if (section === 'empresa') document.getElementById('employer-section').classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // ============================================================
    // FORMULARIO CANDIDATO
    // ============================================================
    document.getElementById('candidate-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const candidate = {
        name: formData.get('name'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        location: formData.get('location'),
        desired_position: formData.get('desired_position'),
        skills: formData.get('skills'),
        experience: formData.get('experience'),
        salary: formData.get('salary'),
        about: formData.get('about'),
        timestamp: new Date().toISOString()
      };

      database.candidates.push(candidate);

      // Guardar en Google Sheets
      try {
        await fetch(SCRIPT_URL, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ type: 'candidato', ...candidate })
        });
      } catch (error) {
        console.log('Guardado local');
      }

      const resultsDiv = document.getElementById('candidate-results');
      const matchesDiv = document.getElementById('candidate-matches');
      resultsDiv.classList.remove('hidden');
      matchesDiv.innerHTML = '<div class="loading"></div><p class="text-center text-gray-600 mt-4">ü§ñ IA analizando vacantes compatibles...</p>';

      await new Promise(resolve => setTimeout(resolve, 2000));
      
      // Recargar datos frescos antes de mostrar matches
      await loadFromSheets();

      const matches = generateCandidateMatches(candidate);
      matchesDiv.innerHTML = '';

      if (matches.length === 0) {
        matchesDiv.innerHTML = `
          <div class="text-center py-8">
            <p class="text-2xl mb-4">üòä</p>
            <p class="text-xl mb-2 font-semibold">Tu perfil fue registrado exitosamente</p>
            <p class="text-gray-600">A√∫n no hay vacantes que coincidan perfectamente, pero ya est√°s en nuestra base de datos.</p>
            <p class="text-sm text-gray-500 mt-4">üìß Registro confirmado para: ${candidate.email}</p>
          </div>`;
      } else {
        matches.forEach(match => { matchesDiv.innerHTML += createJobMatchCard(match); });
      }

      resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
      e.target.reset();
    });

    // ============================================================
    // FORMULARIO EMPRESA
    // ============================================================
    document.getElementById('employer-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const job = {
        company: formData.get('company'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        location: formData.get('location'),
        position: formData.get('position'),
        requirements: formData.get('requirements'),
        experience: formData.get('experience'),
        salary: formData.get('salary'),
        description: formData.get('description'),
        timestamp: new Date().toISOString()
      };

      database.jobs.push(job);

      // Guardar en Google Sheets
      try {
        await fetch(SCRIPT_URL, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ type: 'empresa', ...job })
        });
      } catch (error) {
        console.log('Guardado local');
      }

      const resultsDiv = document.getElementById('employer-results');
      const matchesDiv = document.getElementById('employer-matches');
      resultsDiv.classList.remove('hidden');
      matchesDiv.innerHTML = '<div class="loading"></div><p class="text-center text-gray-600 mt-4">ü§ñ IA analizando candidatos compatibles...</p>';

      await new Promise(resolve => setTimeout(resolve, 2000));

      // Recargar datos frescos
      await loadFromSheets();

      const matches = generateEmployerMatches(job);
      matchesDiv.innerHTML = '';

      if (matches.length === 0) {
        matchesDiv.innerHTML = `
          <div class="text-center py-8">
            <p class="text-2xl mb-4">üòä</p>
            <p class="text-xl mb-2 font-semibold">Tu vacante fue registrada exitosamente</p>
            <p class="text-gray-600">A√∫n no hay candidatos que coincidan perfectamente, pero ya est√°s en nuestra base de datos.</p>
            <p class="text-sm text-gray-500 mt-4">üìß Registro confirmado para: ${job.email}</p>
          </div>`;
      } else {
        matches.forEach(match => { matchesDiv.innerHTML += createCandidateMatchCard(match); });
      }

      resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
      e.target.reset();
    });

    // ============================================================
    // ALGORITMO DE MATCHING
    // ============================================================
    function calculateCompatibility(skills1, skills2, exp1, exp2, loc1, loc2) {
      let score = 0;
      const s1 = skills1.toLowerCase().split(',').map(s => s.trim()).filter(s => s.length > 2);
      const s2 = skills2.toLowerCase().split(',').map(s => s.trim()).filter(s => s.length > 2);
      let matchingSkills = 0;
      s1.forEach(skill => {
        if (s2.some(s => s.includes(skill) || skill.includes(s))) matchingSkills++;
      });
      score += (matchingSkills / Math.max(s1.length, s2.length, 1)) * 60;
      score += (exp1 === exp2) ? 25 : 12;
      score += (loc1.toLowerCase().includes(loc2.toLowerCase()) || loc2.toLowerCase().includes(loc1.toLowerCase())) ? 15 : 5;
      return Math.round(score);
    }

    function generateCandidateMatches(candidate) {
      return database.jobs
        .map(job => ({
          ...job,
          compatibility: calculateCompatibility(
            candidate.skills, job.requirements || '',
            candidate.experience, job.experience,
            candidate.location, job.location
          )
        }))
        .filter(j => j.compatibility >= 40)
        .sort((a, b) => b.compatibility - a.compatibility);
    }

    function generateEmployerMatches(job) {
      return database.candidates
        .map(candidate => ({
          ...candidate,
          compatibility: calculateCompatibility(
            candidate.skills || '', job.requirements,
            candidate.experience, job.experience,
            candidate.location, job.location
          )
        }))
        .filter(c => c.compatibility >= 40)
        .sort((a, b) => b.compatibility - a.compatibility);
    }

    // ============================================================
    // TARJETAS DE RESULTADO
    // ============================================================
    function compatClass(score) { return score >= 80 ? 'high' : score >= 60 ? 'medium' : 'low'; }
    function compatText(score) { return score >= 80 ? 'Alta Compatibilidad' : score >= 60 ? 'Buena Compatibilidad' : 'Compatibilidad B√°sica'; }

    function formatPhone(phone) {
      if (!phone) return '';
      return phone.replace(/\D/g, '');
    }

    function createJobMatchCard(match) {
      const phone = formatPhone(match.phone);
      const waMsg = encodeURIComponent(`Hola, te contacto desde BWIA¬∑AI. Vi que tienen la vacante de ${match.position} y me interesa postularme.`);
      const emailSubject = encodeURIComponent(`Inter√©s en vacante: ${match.position}`);
      const emailBody = encodeURIComponent(`Hola,\n\nLes contacto desde BWIA¬∑AI. Me interesa la vacante de ${match.position}.\n\nQuedo en espera de su respuesta.\n\nSaludos.`);

      return `
        <div class="match-card">
          <div class="flex justify-between items-start mb-3 flex-wrap gap-2">
            <div>
              <h4 class="text-xl font-bold text-gray-900">${match.position || 'Vacante'}</h4>
              <p class="text-gray-600 font-medium">${match.company || ''}</p>
            </div>
            <span class="compatibility-badge ${compatClass(match.compatibility)}">${match.compatibility}% ‚Äî ${compatText(match.compatibility)}</span>
          </div>
          <p class="text-gray-700 mb-3">${match.description || 'Excelente oportunidad de crecimiento profesional'}</p>
          <div class="grid grid-cols-2 gap-3 text-sm mb-3">
            <div><strong>üìç</strong> ${match.location || 'No especificada'}</div>
            <div><strong>üí∞</strong> $${match.salary ? Number(match.salary).toLocaleString() : 'A negociar'} MXN</div>
            <div><strong>‚è±</strong> ${match.experience || 'No especificada'} a√±os exp.</div>
            <div><strong>üéØ</strong> ${compatText(match.compatibility)}</div>
          </div>
          <div class="text-sm text-gray-600 mb-4"><strong>Habilidades buscadas:</strong> ${match.requirements || ''}</div>
          <div class="flex flex-wrap gap-2">
            ${phone ? `<a href="https://wa.me/52${phone}?text=${waMsg}" target="_blank" class="btn-whatsapp">üí¨ WhatsApp</a>` : ''}
            ${match.email ? `<a href="mailto:${match.email}?subject=${emailSubject}&body=${emailBody}" class="btn-email">üìß Email</a>` : ''}
            ${phone ? `<a href="tel:${match.phone}" class="bg-gray-200 text-gray-700 py-2 px-3 rounded-lg text-sm hover:bg-gray-300 transition">üìû Llamar</a>` : ''}
          </div>
        </div>`;
    }

    function createCandidateMatchCard(match) {
      const phone = formatPhone(match.phone);
      const waMsg = encodeURIComponent(`Hola ${match.name}, te contacto desde BWIA¬∑AI. Vi tu perfil y me interesa platicarte sobre una oportunidad laboral.`);
      const emailSubject = encodeURIComponent(`Oportunidad laboral para ti - BWIA¬∑AI`);
      const emailBody = encodeURIComponent(`Hola ${match.name},\n\nTe contactamos desde BWIA¬∑AI. Tu perfil coincide con una de nuestras vacantes y nos gustar√≠a platicarte m√°s al respecto.\n\nSaludos.`);

      return `
        <div class="match-card">
          <div class="flex justify-between items-start mb-3 flex-wrap gap-2">
            <div>
              <h4 class="text-xl font-bold text-gray-900">${match.name || 'Candidato'}</h4>
              <p class="text-gray-600 font-medium">${match.desired_position || ''}</p>
            </div>
            <span class="compatibility-badge ${compatClass(match.compatibility)}">${match.compatibility}% ‚Äî ${compatText(match.compatibility)}</span>
          </div>
          <p class="text-gray-700 mb-3">${match.about || 'Candidato con experiencia relevante'}</p>
          <div class="grid grid-cols-2 gap-3 text-sm mb-3">
            <div><strong>üìç</strong> ${match.location || 'No especificada'}</div>
            <div><strong>üí∞</strong> $${match.salary ? Number(match.salary).toLocaleString() : 'Abierto'} MXN</div>
            <div><strong>‚è±</strong> ${match.experience || ''} a√±os exp.</div>
            <div><strong>üéØ</strong> ${compatText(match.compatibility)}</div>
          </div>
          <div class="text-sm text-gray-600 mb-2"><strong>Habilidades:</strong> ${match.skills || ''}</div>
          <div class="flex flex-wrap gap-2 mt-4">
            ${phone ? `<a href="https://wa.me/52${phone}?text=${waMsg}" target="_blank" class="btn-whatsapp">üí¨ WhatsApp</a>` : ''}
            ${match.email ? `<a href="mailto:${match.email}?subject=${emailSubject}&body=${emailBody}" class="btn-email">üìß Email</a>` : ''}
            ${phone ? `<a href="tel:${match.phone}" class="bg-gray-200 text-gray-700 py-2 px-3 rounded-lg text-sm hover:bg-gray-300 transition">üìû Llamar</a>` : ''}
          </div>
        </div>`;
    }
  </script>
</body>
</html>
